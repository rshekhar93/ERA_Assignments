# CIFAR10 Custom Network Implementation

This project implements a custom CNN architecture for the CIFAR10 dataset using PyTorch.

## Architecture Details

### Network Structure (C1C2C3C40)
1. **C1 Block** (RF: 1->3->5)
   - Conv 3x3 (3->16) [32x32 -> 30x30]
   - Conv 3x3 (16->24) [30x30 -> 28x28]
   - No padding to increase RF properly

2. **C2 Block** (RF: 5->9->13)
   - Depthwise Separable Conv 3x3 (24->32) with dilation=2 [28x28 -> 28x28]
   - Strided Conv 3x3 s=2 (32->40) [28x28 -> 14x14]

3. **C3 Block** (RF: 13->29->37)
   - Dilated Conv 3x3 d=4 (40->64) [14x14 -> 14x14]
   - Dilated Conv 3x3 d=2 (64->80) [14x14 -> 14x14]

4. **C40 Block** (RF: 37->49->49)
   - Dilated Conv 3x3 d=3 (80->96) [14x14 -> 14x14]
   - Conv 1x1 (96->64) [14x14 -> 14x14]
   - Global Average Pooling [14x14 -> 1x1]
   - FC Layers: 64->128->10 with dropout(0.2)

### Key Features
- Total RF: 49x49
- Multiple dilated convolutions (d=2,3,4)
- Depthwise Separable Convolution
- Global Average Pooling with FC layers
- Parameters < 200k

### Training Configuration
- Optimizer: SGD
  - Learning rate: 0.03
  - Momentum: 0.95
  - Weight decay: 5e-4
- Scheduler: ReduceLROnPlateau
  - Factor: 0.2
  - Patience: 2
  - Mode: max (tracking accuracy)
- Epochs: 40

### Data Augmentation
Using Albumentations library:
- Horizontal Flip (p=0.5)
- ShiftScaleRotate (shift_limit=0.1, scale_limit=0.1, rotate_limit=10°)
- CoarseDropout (max_holes=1, max_height=16px, max_width=16px)

## Requirements
```bash
pip install -r requirements.txt
```

## Model Summary
```
Model Architecture:
----------------------------------------------------------------
        Layer (type)               Output Shape         Param #
================================================================
            Conv2d-1           [-1, 16, 30, 30]             448
       BatchNorm2d-2           [-1, 16, 30, 30]              32
              ReLU-3           [-1, 16, 30, 30]               0
            Conv2d-4           [-1, 24, 28, 28]           3,480
       BatchNorm2d-5           [-1, 24, 28, 28]              48
              ReLU-6           [-1, 24, 28, 28]               0
            Conv2d-7           [-1, 24, 28, 28]             240
            Conv2d-8           [-1, 32, 28, 28]             800
DepthwiseSeparableConv-9       [-1, 32, 28, 28]               0
      BatchNorm2d-10           [-1, 32, 28, 28]              64
             ReLU-11           [-1, 32, 28, 28]               0
           Conv2d-12           [-1, 40, 14, 14]          11,560
      BatchNorm2d-13           [-1, 40, 14, 14]              80
             ReLU-14           [-1, 40, 14, 14]               0
           Conv2d-15           [-1, 64, 14, 14]          23,104
      BatchNorm2d-16           [-1, 64, 14, 14]             128
             ReLU-17           [-1, 64, 14, 14]               0
           Conv2d-18           [-1, 80, 14, 14]          46,160
      BatchNorm2d-19           [-1, 80, 14, 14]             160
             ReLU-20           [-1, 80, 14, 14]               0
           Conv2d-21           [-1, 96, 14, 14]          69,216
      BatchNorm2d-22           [-1, 96, 14, 14]             192
             ReLU-23           [-1, 96, 14, 14]               0
           Conv2d-24           [-1, 64, 14, 14]           6,208
AdaptiveAvgPool2d-25             [-1, 64, 1, 1]               0
           Linear-26                  [-1, 128]           8,320
             ReLU-27                  [-1, 128]               0
          Dropout-28                  [-1, 128]               0
           Linear-29                   [-1, 10]           1,290
================================================================
Total params: 171,530
Trainable params: 171,530
Non-trainable params: 0
----------------------------------------------------------------
Input size (MB): 0.01
Forward/backward pass size (MB): 3.02
Params size (MB): 0.65
Estimated Total Size (MB): 3.69
----------------------------------------------------------------
```

## Training Logs
```
Epoch: 1 Loss: 1.3708 Acc: 31.55%: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:36<00:00, 10.57it/s]
Test set: Average loss: 1.5099, Accuracy: 44.11%
Epoch 1: Train Acc: 31.55%, Test Acc: 44.11%
Epoch: 2 Loss: 1.4657 Acc: 47.30%: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:34<00:00, 11.21it/s] 
Test set: Average loss: 1.2792, Accuracy: 53.75%
Epoch 2: Train Acc: 47.30%, Test Acc: 53.75%
Epoch: 3 Loss: 1.3076 Acc: 54.38%: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:41<00:00,  9.43it/s] 
Test set: Average loss: 1.0679, Accuracy: 61.80%
Epoch 3: Train Acc: 54.38%, Test Acc: 61.80%
Epoch: 4 Loss: 1.2232 Acc: 59.58%: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:40<00:00,  9.61it/s] 
Test set: Average loss: 0.9801, Accuracy: 65.11%
Epoch 4: Train Acc: 59.58%, Test Acc: 65.11%
Epoch: 5 Loss: 1.0464 Acc: 62.61%: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:35<00:00, 11.16it/s] 
Test set: Average loss: 0.9494, Accuracy: 66.26%
Epoch 5: Train Acc: 62.61%, Test Acc: 66.26%
Epoch: 6 Loss: 0.8519 Acc: 64.55%: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:34<00:00, 11.45it/s]
Test set: Average loss: 0.9583, Accuracy: 67.46%
Epoch 6: Train Acc: 64.55%, Test Acc: 67.46%
Epoch: 7 Loss: 0.9510 Acc: 66.32%: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:35<00:00, 11.05it/s]
Test set: Average loss: 0.9822, Accuracy: 67.13%
Epoch 7: Train Acc: 66.32%, Test Acc: 67.13%
Epoch: 8 Loss: 0.9384 Acc: 67.62%: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:34<00:00, 11.42it/s] 
Test set: Average loss: 0.7392, Accuracy: 74.18%
Epoch 8: Train Acc: 67.62%, Test Acc: 74.18%
Epoch: 9 Loss: 1.0602 Acc: 68.63%: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:34<00:00, 11.38it/s] 
Test set: Average loss: 0.7871, Accuracy: 72.92%
Epoch 9: Train Acc: 68.63%, Test Acc: 72.92%
Epoch: 10 Loss: 0.9393 Acc: 69.71%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:34<00:00, 11.21it/s] 
Test set: Average loss: 0.8853, Accuracy: 69.86%
Epoch 10: Train Acc: 69.71%, Test Acc: 69.86%
Epoch: 11 Loss: 0.8090 Acc: 70.20%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:34<00:00, 11.42it/s] 
Test set: Average loss: 0.7057, Accuracy: 75.88%
Epoch 11: Train Acc: 70.20%, Test Acc: 75.88%
Epoch: 12 Loss: 0.7922 Acc: 71.04%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:35<00:00, 11.14it/s] 
Test set: Average loss: 0.7512, Accuracy: 74.12%
Epoch 12: Train Acc: 71.04%, Test Acc: 74.12%
Epoch: 13 Loss: 0.7894 Acc: 70.85%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:34<00:00, 11.43it/s] 
Test set: Average loss: 0.7084, Accuracy: 75.67%
Epoch 13: Train Acc: 70.85%, Test Acc: 75.67%
Epoch: 14 Loss: 0.9893 Acc: 71.65%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:41<00:00,  9.38it/s] 
Test set: Average loss: 0.7586, Accuracy: 73.85%
Epoch 14: Train Acc: 71.65%, Test Acc: 73.85%
Epoch: 15 Loss: 0.7282 Acc: 76.47%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:43<00:00,  9.06it/s] 
Test set: Average loss: 0.5151, Accuracy: 82.13%
Epoch 15: Train Acc: 76.47%, Test Acc: 82.13%
Epoch: 16 Loss: 0.4736 Acc: 77.96%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:41<00:00,  9.36it/s] 
Test set: Average loss: 0.5083, Accuracy: 82.45%
Epoch 16: Train Acc: 77.96%, Test Acc: 82.45%
Epoch: 17 Loss: 0.6617 Acc: 78.23%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:42<00:00,  9.25it/s]
Test set: Average loss: 0.5004, Accuracy: 82.62%
Epoch 17: Train Acc: 78.23%, Test Acc: 82.62%
Epoch: 18 Loss: 0.8525 Acc: 78.36%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:41<00:00,  9.32it/s] 
Test set: Average loss: 0.5112, Accuracy: 82.38%
Epoch 18: Train Acc: 78.36%, Test Acc: 82.38%
Epoch: 19 Loss: 0.6537 Acc: 78.91%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:41<00:00,  9.38it/s] 
Test set: Average loss: 0.4915, Accuracy: 82.93%
Epoch 19: Train Acc: 78.91%, Test Acc: 82.93%
Epoch: 20 Loss: 0.4647 Acc: 78.91%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:41<00:00,  9.38it/s] 
Test set: Average loss: 0.4935, Accuracy: 82.83%
Epoch 20: Train Acc: 78.91%, Test Acc: 82.83%
Epoch: 21 Loss: 0.7667 Acc: 79.04%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:41<00:00,  9.48it/s] 
Test set: Average loss: 0.4929, Accuracy: 82.94%
Epoch 21: Train Acc: 79.04%, Test Acc: 82.94%
Epoch: 22 Loss: 0.6021 Acc: 79.21%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:41<00:00,  9.44it/s] 
Test set: Average loss: 0.4902, Accuracy: 82.82%
Epoch 22: Train Acc: 79.21%, Test Acc: 82.82%
Epoch: 23 Loss: 0.6481 Acc: 79.40%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:41<00:00,  9.45it/s] 
Test set: Average loss: 0.4660, Accuracy: 84.02%
Epoch 23: Train Acc: 79.40%, Test Acc: 84.02%
Epoch: 24 Loss: 0.4685 Acc: 79.57%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:41<00:00,  9.34it/s] 
Test set: Average loss: 0.5134, Accuracy: 82.75%
Epoch 24: Train Acc: 79.57%, Test Acc: 82.75%
Epoch: 25 Loss: 0.6999 Acc: 79.77%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:42<00:00,  9.18it/s] 
Test set: Average loss: 0.4949, Accuracy: 82.93%
Epoch 25: Train Acc: 79.77%, Test Acc: 82.93%
Epoch: 26 Loss: 0.7712 Acc: 79.57%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:41<00:00,  9.46it/s] 
Test set: Average loss: 0.5183, Accuracy: 82.47%
Epoch 26: Train Acc: 79.57%, Test Acc: 82.47%
Epoch: 27 Loss: 0.6632 Acc: 81.65%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:42<00:00,  9.20it/s] 
Test set: Average loss: 0.4373, Accuracy: 85.17%
Epoch 27: Train Acc: 81.65%, Test Acc: 85.17%
Epoch: 28 Loss: 0.5869 Acc: 82.14%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:43<00:00,  9.07it/s] 
Test set: Average loss: 0.4286, Accuracy: 85.14%
Epoch 28: Train Acc: 82.14%, Test Acc: 85.14%
Epoch: 29 Loss: 0.4288 Acc: 82.27%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:42<00:00,  9.24it/s] 
Test set: Average loss: 0.4228, Accuracy: 85.47%
Epoch 29: Train Acc: 82.27%, Test Acc: 85.47%
Epoch: 30 Loss: 0.5210 Acc: 82.60%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:42<00:00,  9.29it/s] 
Test set: Average loss: 0.4260, Accuracy: 85.22%
Epoch 30: Train Acc: 82.60%, Test Acc: 85.22%
Epoch: 31 Loss: 0.5489 Acc: 82.55%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:42<00:00,  9.24it/s] 
Test set: Average loss: 0.4248, Accuracy: 85.40%
Epoch 31: Train Acc: 82.55%, Test Acc: 85.40%
Epoch: 32 Loss: 0.4795 Acc: 82.78%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:34<00:00, 11.30it/s] 
Test set: Average loss: 0.4254, Accuracy: 85.33%
Epoch 32: Train Acc: 82.78%, Test Acc: 85.33%
Epoch: 33 Loss: 0.5901 Acc: 83.14%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:34<00:00, 11.35it/s] 
Test set: Average loss: 0.4161, Accuracy: 85.53%
Epoch 33: Train Acc: 83.14%, Test Acc: 85.53%
Epoch: 34 Loss: 0.4840 Acc: 83.19%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:39<00:00,  9.95it/s] 
Test set: Average loss: 0.4131, Accuracy: 85.82%
Epoch 34: Train Acc: 83.19%, Test Acc: 85.82%
Epoch: 35 Loss: 0.6042 Acc: 83.31%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:43<00:00,  8.92it/s] 
Test set: Average loss: 0.4107, Accuracy: 85.83%
Epoch 35: Train Acc: 83.31%, Test Acc: 85.83%
Epoch: 36 Loss: 0.4769 Acc: 83.39%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:42<00:00,  9.26it/s] 
Test set: Average loss: 0.4130, Accuracy: 85.74%
Epoch 36: Train Acc: 83.39%, Test Acc: 85.74%
Epoch: 37 Loss: 0.5769 Acc: 83.46%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:41<00:00,  9.47it/s]
Test set: Average loss: 0.4101, Accuracy: 85.82%
Epoch 37: Train Acc: 83.46%, Test Acc: 85.82%
Epoch: 38 Loss: 0.5282 Acc: 83.35%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:41<00:00,  9.41it/s]
Test set: Average loss: 0.4116, Accuracy: 85.89%
Epoch 38: Train Acc: 83.35%, Test Acc: 85.89%
Epoch: 39 Loss: 0.4614 Acc: 83.32%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:42<00:00,  9.22it/s]
Test set: Average loss: 0.4123, Accuracy: 85.82%
Epoch 39: Train Acc: 83.32%, Test Acc: 85.82%
Epoch: 40 Loss: 0.4339 Acc: 83.82%: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 391/391 [00:40<00:00,  9.58it/s]
Test set: Average loss: 0.4102, Accuracy: 85.75%
Epoch 40: Train Acc: 83.82%, Test Acc: 85.75%
```

## Results
- Best Test Accuracy: 85.89%
- Total Parameters: 171,530